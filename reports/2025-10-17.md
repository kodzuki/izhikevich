# üìù Reporte de sesi√≥n ‚Äì Neurodelays

**Fecha:** 2025-10-17  
**Participantes:** Usuario, Claude  
**Contexto inicial:** Sesi√≥n te√≥rica sobre m√©tricas de conectividad funcional (PLV, PLI, coherencia, cross-correlation, autocorrelaci√≥n) y su interpretaci√≥n en experimentos de distribuciones de delays entre ROIs

---

## üéØ Objetivo de la sesi√≥n

Establecer fundamentos te√≥ricos para interpretar m√©tricas de sincronizaci√≥n y desarrollar metodolog√≠a de clasificaci√≥n de distribuciones de delays mediante ratio PLV/PLI.

---

## üõ†Ô∏è Actividades realizadas

* Explicaci√≥n detallada de PLV (Phase Locking Value) y PLI (Phase Lag Index): definiciones matem√°ticas, interpretaci√≥n y diferencias clave
* An√°lisis de relaciones entre m√©tricas: coherencia, cross-correlation, autocorrelaci√≥n, power spectrum, envelope correlation
* Desarrollo de firmas caracter√≠sticas de distribuciones de delays (delta, gaussiana, lognormal, bimodal)
* Dise√±o de pipeline de clasificaci√≥n basado en PLV/PLI ratio y features derivadas
* Propuesta de an√°lisis de distribuci√≥n de diferencias de fase ŒîŒ¶ (polar plots + histogramas)
* Explicaci√≥n de intrinsic timescale (œÑ): m√©todos de c√°lculo (1/e decay, fit exponencial, integral, AR model)
* Clarificaci√≥n de conceptos: SNR, potencia vs varianza, autocorrelaci√≥n vs cross-correlation

---

## üìä Resultados / hallazgos

* **PLV/PLI ratio** como biomarcador de estructura temporal de delays:
  - ratio <15%: delays largos/unidireccionales
  - ratio 35-60%: componente instant√°neo fuerte
* **Coherencia espectral** falla en sincronizaci√≥n intermitente; PLV m√°s robusto para din√°mica neuronal real
* **Envelope correlation > PLV**: indica que modulaci√≥n de amplitud domina sobre sincronizaci√≥n de fase (com√∫n con delays largos)
* Correlaciones esperadas: delay_mean‚Üë ‚Üí PLV/PLI_ratio‚Üì; delay_CV‚Üë ‚Üí ratio‚Üë
* Distribuci√≥n de ŒîŒ¶ revela geometr√≠a de acoplamiento: pico estrecho en 0 ‚Üí near_zero >40% (delays cortos)

---

## üìÇ Archivos/notebooks afectados

* `src/two_populations/metrics.py` (propuesta: a√±adir `analyze_phase_difference_distribution()`)
* `src/two_populations/plots/dashboard_plots.py` (propuesta: plots polares ŒîŒ¶)
* An√°lisis futuros sobre `results/results_database_*.pkl`

---

## ‚úÖ Decisiones tomadas

* Usar PLV/PLI ratio como feature principal para clasificar distribuciones de delays
* Calcular distribuci√≥n emp√≠rica de ŒîŒ¶ (50 bins, [-œÄ,œÄ]) con m√©tricas: near_zero_fraction, asymmetry, circular_variance
* Priorizar 7 features para regresi√≥n/clasificaci√≥n: plv_pli_ratio, pli_normalized, env_vs_plv, cc_peak, cc_lag_abs, phase_amplitude_balance, sync_quality
* Implementar visualizaci√≥n dual: diagrama polar (scatter + vector PLV) + histograma lineal de ŒîŒ¶
* Mantener 4 m√©todos de c√°lculo de œÑ documentados: 1/e decay (actual), fit exponencial, integral, AR model

---

## üîú Pr√≥ximos pasos

* [ ] Implementar `analyze_phase_difference_distribution()` en `metrics.py`
* [ ] A√±adir `plot_phase_distribution_polar()` a `dashboard_plots.py`
* [ ] Calcular correlaciones Pearson delay_params ‚Üí features en results_database
* [ ] Entrenar RandomForest para predecir delay_mean desde features PLV/PLI/env_corr
* [ ] Validar clasificador con sweep: 5 distribuciones √ó m√∫ltiples par√°metros √ó 3 trials
* [ ] Generar checklist diagn√≥stico automatizado (7 criterios) por simulaci√≥n

---

## üìö Referencias consultadas

* **Lachaux et al. (1999):** PLV fundacional - doi:10.1002/(SICI)1097-0193
* **Stam et al. (2007):** Phase Lag Index - doi:10.1002/hbm.20346
* **Aydore et al. (2013):** Propiedades PLV y coherencia - NeuroImage 74:231-244
* **Vinck et al. (2011):** wPLI y bias correction - NeuroImage 55:1548-1565
* **Bastos & Schoffelen (2016):** Tutorial connectivity - Frontiers in Systems Neuroscience 9:175